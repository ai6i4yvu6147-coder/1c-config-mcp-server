# 1C-Config MCP Server — заметки для ИИ и разработчиков

Документ для AI-ассистентов и разработчиков: особенности проекта, соглашения, где что искать.

## Лог доработок

При внесении изменений в код (парсер, сервер, схему БД, документацию и т.п.) **нужно обновлять лог доработок** — файл [CHANGELOG.md](CHANGELOG.md) в корне проекта. Формат: дата (день), под ней список пунктов с кратким описанием каждой доработки. Группировка только по дню, без точного времени. **Одна доработка — один пункт:** если правка дополняет уже описанную сегодняшнюю запись (та же фича/область), редактируйте существующий пункт, а не добавляйте новый.

## Цикл проверки изменений (тестирование на реальном MCP)

Изменения в коде проверяются на **реальном MCP** после пересборки и пересоздания данных, а не синтетическими тестами до обновления данных.

1. **ИИ вносит правки в код** (парсер, сервер, описание инструментов и т.д.).
2. **Пользователь пересобирает MCP и пересоздаёт базы** (в Admin — заново загружает выгрузку конфигурации в БД).
3. **Пользователь пишет ИИ**, что пересборка и пересоздание выполнены.
4. **ИИ тестирует результат** через реальные вызовы MCP-инструментов (list_active_databases, get_object_structure, search_code и т.д.) и по ответам проверяет корректность.

До шага 3 не запускать синтетические тесты, предполагающие актуальные данные в БД: данные обновляются только после пересборки и пересоздания баз пользователем.

## Базы данных

**Миграции не используются.** При изменении парсера или схемы БД существующие базы не обновляются — базы создаются всегда заново. Пользователь заново указывает Configuration.xml и нажимает «Создать» в Admin; старые .db при необходимости удаляются или заменяются.

## Универсальность

Проект рассчитан на любой MCP-клиент (любой ИИ-ассистент с поддержкой MCP), а не на конкретный продукт. В пользовательской документации (readme.txt) упоминается настройка на примере конфигурационного файла клиента; имя файла и путь зависят от конкретного приложения.

## Структура

- **shared/xml_parser.py** — парсинг XML выгрузки конфигурации 1С.
- **admin_tool/** — приложение создания/управления базами (загрузка Configuration.xml → SQLite).
- **server/** — MCP-сервер: инструменты поиска по коду, структуре, формам; читает данные из выбранной БД.

## Добавление полей в схему

При добавлении новых полей (например, комментариев реквизитов): изменить только `CREATE TABLE` и соответствующие `INSERT`/`SELECT` в admin_tool и server. Логику миграции старых БД не добавлять.
